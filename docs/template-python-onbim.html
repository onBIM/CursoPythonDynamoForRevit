<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-11-27T13:33:15.2898762"><title>Template Python onBIM | Conteúdo do Curso Python para Dynamo do Revit</title><script type="application/json" id="virtual-toc-data">[{"id":"explica-o-linha-a-linha","level":0,"title":"Explicação linha a linha","anchor":"#explica-o-linha-a-linha"},{"id":"como-usar-o-template-no-pycharm","level":0,"title":"Como usar o Template no PyCharm","anchor":"#como-usar-o-template-no-pycharm"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Template Python onBIM | Conteúdo do Curso Python para Dynamo do Revit"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Conteúdo do Curso Python para Dynamo do Revit Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/template-python-onbim.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Template Python onBIM | Conteúdo do Curso Python para Dynamo do Revit"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/template-python-onbim.html#webpage",
    "url": "writerside-documentation/template-python-onbim.html",
    "name": "Template Python onBIM | Conteúdo do Curso Python para Dynamo do Revit",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Conteúdo do Curso Python para Dynamo do Revit Help"
}</script><!-- End Schema.org --></head><body data-id="Template-Python-onBIM" data-main-title="Template Python onBIM" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Aula-001.md|Aula 001"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Conteúdo do Curso Python para Dynamo do Revit  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Template-Python-onBIM" id="Template-Python-onBIM.md">Template Python onBIM</h1><p id="-16uigk_3">O template Python onBIM &eacute; um arquivo Python que cont&eacute;m um conjunto de imports e un&ccedil;&otilde;es, comumente utilizadas em scripts para programar para a API do Revit.</p><p id="-16uigk_4">Ele &eacute; dividido em se&ccedil;&otilde;es que facilitam a organiza&ccedil;&atilde;o do c&oacute;digo e a compreens&atilde;o do que cada parte do c&oacute;digo faz.</p><p id="-16uigk_5">Se&ccedil;&otilde;es do template onBIM:</p><ul class="list _bullet" id="-16uigk_6"><li class="list__item" id="-16uigk_10"><p><span class="control" id="-16uigk_15">Header</span> (cont&eacute;m informa&ccedil;&otilde;es sobre o arquivo)</p></li><li class="list__item" id="-16uigk_11"><p><span class="control" id="-16uigk_16">References and Imports</span> (cont&eacute;m as refer&ecirc;ncias e imports necess&aacute;rios)</p></li><li class="list__item" id="-16uigk_12"><p><span class="control" id="-16uigk_17">Classes and Functions</span> (cont&eacute;m as fun&ccedil;&otilde;es e classes)</p></li><li class="list__item" id="-16uigk_13"><p><span class="control" id="-16uigk_18">Inputs and Variables Declarations</span> (cont&eacute;m as declara&ccedil;&otilde;es de vari&aacute;veis e inputs)</p></li><li class="list__item" id="-16uigk_14"><p><span class="control" id="-16uigk_19">Main Code</span> (cont&eacute;m o c&oacute;digo principal)</p></li></ul><div class="code-block" data-lang="python">
# by onBIM Technology
# www.onbim.net
# file name: ./${DIR_PATH}/${FILE_NAME}

# REFERENCES AND IMPORTS
# BEGIN&gt;&gt;&gt;&gt;&gt;

# &lt;&lt;&lt; Python Modules &gt;&gt;&gt;
# BEGIN

# REFERENCES AND IMPORTS
# END&lt;&lt;&lt;&lt;&lt;

# CLASSES AND FUNCTIONS
# BEGIN&gt;&gt;&gt;&gt;&gt;

# &lt;&lt;&lt; Your classes and functions here &gt;&gt;&gt;

# CLASSES AND FUNCTIONS
# END&lt;&lt;&lt;&lt;&lt;

# INPUTS AND VARIABLES DECLARATIONS
# BEGIN&gt;&gt;&gt;&gt;&gt;

# INPUTS AND VARIABLES DECLARATIONS
# END&lt;&lt;&lt;&lt;&lt;

# MAIN CODE
# BEGIN&gt;&gt;&gt;&gt;&gt;

# MAIN CODE
# END&lt;&lt;&lt;&lt;&lt;
</div><section class="chapter"><h2 id="explica-o-linha-a-linha" data-toc="explica-o-linha-a-linha">Explica&ccedil;&atilde;o linha a linha</h2><section class="chapter"><h3 id="imports" data-toc="imports">Imports</h3><section class="chapter"><h4 id="importa-o-m-dulo-de-common-language-runtime-clr-do-python" data-toc="importa-o-m-dulo-de-common-language-runtime-clr-do-python">Importa o m&oacute;dulo de Common Language Runtime (CLR) do Python.</h4><p id="-16uigk_40">Esse m&oacute;dulo &eacute; necess&aacute;rio para importar as demais bibliotecas que n&atilde;o s&atilde;o do Python, como refer&ecirc;ncias para o .NET, API do Revit e do Dynamo.</p><div class="code-block" data-lang="python">
import clr
</div></section><section class="chapter"><h4 id="importa-o-m-dulo-system-do-windows" data-toc="importa-o-m-dulo-system-do-windows">Importa o m&oacute;dulo System do Windows.</h4><p id="-16uigk_42">Esse m&oacute;dulo &eacute; necess&aacute;rio para importar as classes e fun&ccedil;&otilde;es do .NET.</p><div class="code-block" data-lang="python">
import System
</div></section><section class="chapter"><h4 id="importa-o-m-dulo-traceback" data-toc="importa-o-m-dulo-traceback">Importa o m&oacute;dulo traceback.</h4><p id="-16uigk_44">Esse m&oacute;dulo &eacute; necess&aacute;rio para imprimir mensagens de erro no console.</p><div class="code-block" data-lang="python">
import traceback
</div></section><section class="chapter"><h4 id="adiciona-a-refer-ncia-para-list-do-net" data-toc="adiciona-a-refer-ncia-para-list-do-net">Adiciona a refer&ecirc;ncia para List do .NET.</h4><p id="-16uigk_46">Perceba &eacute; usado o <span class="emphasis" id="-16uigk_48">alias</span> <code class="code" id="-16uigk_49">SystemList</code> para evitar conflitos com a classe List de outras bibliotecas.</p><div class="code-block" data-lang="python">
clr.AddReference(&quot;System.Core&quot;)
from System.Collections.Generic import List as SystemList
</div></section><section class="chapter"><h4 id="importa-os-m-todos-de-extens-o-do-linq" data-toc="importa-os-m-todos-de-extens-o-do-linq">Importa os m&eacute;todos de extens&atilde;o do LINQ.</h4><p id="-16uigk_50">Linq &eacute; uma biblioteca do .NET que permite realizar consultas em cole&ccedil;&otilde;es de objetos.</p><div class="code-block" data-lang="python">
clr.ImportExtensions(System.Linq)
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-nodes-de-geometria-do-dynamo" data-toc="adiciona-refer-ncia-para-os-nodes-de-geometria-do-dynamo">Adiciona refer&ecirc;ncia para os nodes de Geometria do Dynamo.</h4><p id="-16uigk_52">Com esse import voc&ecirc; poder&aacute; usar os nodes de geometria do Dynamo no seu script.</p><div class="code-block" data-lang="python">
clr.AddReference('ProtoGeometry')
from Autodesk.DesignScript import Geometry as DynamoGeometry
</div><figure id="-16uigk_54"><img alt="dyn_geo_import.png" src="images/dyn_geo_import.png" title="dyn_geo_import.png" width="1318" height="886"></figure></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-nodes-de-listas-do-dynamo" data-toc="adiciona-refer-ncia-para-os-nodes-de-listas-do-dynamo">Adiciona refer&ecirc;ncia para os <span class="emphasis" id="-16uigk_58">nodes</span> de Listas do Dynamo.</h4><div class="code-block" data-lang="python">
clr.AddReference('DSCoreNodes')
from DSCore import List as DynamoList
</div><figure id="-16uigk_57"><img alt="dscore_list_nodes_import.png" src="images/dscore_list_nodes_import.png" title="dscore_list_nodes_import.png" width="1335" height="591"></figure></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-nodes-de-cores-do-dynamo" data-toc="adiciona-refer-ncia-para-os-nodes-de-cores-do-dynamo">Adiciona refer&ecirc;ncia para os <span class="emphasis" id="-16uigk_62">nodes</span> de cores do Dynamo.</h4><div class="code-block" data-lang="python">
clr.AddReference('DSCoreNodes')
from DSCore import Color as DynamoColor
</div><figure id="-16uigk_61"><img alt="dscore_color_nodes_import.png" src="images/dscore_color_nodes_import.png" title="dscore_color_nodes_import.png" width="1340" height="703"></figure></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-nodes-de-coloriza-o-de-geometria-do-dynamo" data-toc="adiciona-refer-ncia-para-os-nodes-de-coloriza-o-de-geometria-do-dynamo">Adiciona refer&ecirc;ncia para os <span class="emphasis" id="-16uigk_66">nodes</span> de Coloriza&ccedil;&atilde;o de Geometria do Dynamo.</h4><div class="code-block" data-lang="python">
clr.AddReference('GeometryColor')
from Modifiers import GeometryColor as DynamoGeometryColorize
</div><figure id="-16uigk_65"><img alt="geometry_colorize_import.png" src="images/geometry_colorize_import.png" title="geometry_colorize_import.png" width="1256" height="458"></figure></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-nodes-de-revit-do-dynamo" data-toc="adiciona-refer-ncia-para-os-nodes-de-revit-do-dynamo">Adiciona refer&ecirc;ncia para os <span class="emphasis" id="-16uigk_70">nodes</span> de Revit do Dynamo.</h4><div class="code-block" data-lang="python">
clr.AddReference(&quot;RevitNodes&quot;)
import Revit as RevitNodes
</div><figure id="-16uigk_69"><img alt="revit_nodes_import.png" src="images/revit_nodes_import.png" title="revit_nodes_import.png" width="1340" height="601"></figure></section><section class="chapter"><h4 id="importa-os-m-todos-de-extens-o-para-convers-o-de-elementos-e-geometria-entre-o-revit-e-o-dynamo" data-toc="importa-os-m-todos-de-extens-o-para-convers-o-de-elementos-e-geometria-entre-o-revit-e-o-dynamo">Importa os m&eacute;todos de extens&atilde;o para convers&atilde;o de Elementos e Geometria entre o Revit e o Dynamo.</h4><div class="code-block" data-lang="python">
clr.ImportExtensions(RevitNodes.Elements)
clr.ImportExtensions(RevitNodes.GeometryConversion)
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-servi-os-do-dynamo-que-permitem-acessar-o-documento-do-revit-e-gerenciar-transa-es" data-toc="adiciona-refer-ncia-para-os-servi-os-do-dynamo-que-permitem-acessar-o-documento-do-revit-e-gerenciar-transa-es">Adiciona refer&ecirc;ncia para os servi&ccedil;os do Dynamo que permitem acessar o documento do Revit e gerenciar transa&ccedil;&otilde;es.</h4><ul class="list _bullet" id="-16uigk_72"><li class="list__item" id="-16uigk_74"><p>O documento do Revit &eacute; o arquivo de projeto que est&aacute; sendo editado.</p></li><li class="list__item" id="-16uigk_75"><p>As transa&ccedil;&otilde;es s&atilde;o opera&ccedil;&otilde;es necess&aacute;rias para alterar o modelo do Revit.</p></li></ul><div class="code-block" data-lang="python">
clr.AddReference(&quot;RevitServices&quot;)
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-a-api-do-revit" data-toc="adiciona-refer-ncia-para-a-api-do-revit">Adiciona refer&ecirc;ncia para a API do Revit.</h4><p id="-16uigk_76">A API do Revit &eacute; um conjunto de classes e m&eacute;todos que permitem acessar e modificar o modelo do Revit.</p><div class="code-block" data-lang="python">
clr.AddReference(&quot;RevitAPI&quot;)
import Autodesk
from Autodesk.Revit.DB import *
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-a-interface-de-usu-rio-da-api-do-revit" data-toc="adiciona-refer-ncia-para-a-interface-de-usu-rio-da-api-do-revit">Adiciona refer&ecirc;ncia para a interface de usu&aacute;rio da API do Revit.</h4><p id="-16uigk_78">Essa biblioteca permite criar janelas, barras de ferramentas e outros elementos de interface gr&aacute;fica.</p><div class="code-block" data-lang="python">
clr.AddReference(&quot;RevitAPIUI&quot;)
from Autodesk.Revit.UI import *
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-a-api-ifc-do-revit" data-toc="adiciona-refer-ncia-para-a-api-ifc-do-revit">Adiciona refer&ecirc;ncia para a API IFC do Revit.</h4><p id="-16uigk_80">Essa biblioteca permite acessar recursos especiais para importa&ccedil;&atilde;o e exporta&ccedil;&atilde;o de arquivos IFC.</p><p id="-16uigk_81">Esses recursos podem ser utilizados tamb&eacute;m para manipular elementos nativos do Revit</p><div class="code-block" data-lang="python">
clr.AddReference('RevitAPIIFC')
from Autodesk.Revit.DB.IFC import *
</div></section><section class="chapter"><h4 id="adiciona-refer-ncia-para-os-eventos-do-dynamo" data-toc="adiciona-refer-ncia-para-os-eventos-do-dynamo">Adiciona refer&ecirc;ncia para os eventos do Dynamo.</h4><div class="code-block" data-lang="python">
clr.AddReference('DynamoServices')
from Dynamo import Events as DynamoEvents
</div><p id="-16uigk_84">Uma das coisas importantes que d&aacute; para capturar com esses eventos &eacute; o acesso ao Documento do Dynamo, como mostrado abaixo:</p><div class="code-block" data-lang="python">
workspaceFullPath = DynamoEvents.ExecutionEvents.ActiveSession.CurrentWorkspacePath
workspacePath = '\\'.join(workspaceFullPath.split('\\')[0:-1])
</div></section></section><section class="chapter"><h3 id="vari-veis-que-d-o-acesso-a-recursos-do-revit" data-toc="vari-veis-que-d-o-acesso-a-recursos-do-revit">Vari&aacute;veis que d&atilde;o acesso a recursos do Revit.</h3><div class="code-block" data-lang="python">
doc = DocumentManager.Instance.CurrentDBDocument
uidoc = DocumentManager.Instance.CurrentUIApplication.ActiveUIDocument
app = uiapp.Application
uiapp = DocumentManager.Instance.CurrentUIApplication
</div><ul class="list _bullet" id="-16uigk_87"><li class="list__item" id="-16uigk_88"><p id="-16uigk_92"><code class="code" id="-16uigk_93">doc</code> &eacute; o documento ativo no Revit. O modelo que est&aacute; aberto no momento e que o Dynamo est&aacute; apontando.</p></li><li class="list__item" id="-16uigk_89"><p id="-16uigk_94"><code class="code" id="-16uigk_95">uidoc</code> D&aacute; acesso a recursos da interface do Documento ativo no Revit. Com essa vari&aacute;vel podemos acessar coisas como a sele&ccedil;&atilde;o de elementos, a vista ativa, etc.</p></li><li class="list__item" id="-16uigk_90"><p id="-16uigk_96"><code class="code" id="-16uigk_97">app</code> &eacute; a aplica&ccedil;&atilde;o do Revit. D&aacute; acesso ao Revit como aplica&ccedil;&atilde;o. Nessa vari&aacute;vel podemos encontrar coisas como a vers&atilde;o do Revit, o idioma, etc.</p></li><li class="list__item" id="-16uigk_91"><p id="-16uigk_98"><code class="code" id="-16uigk_99">uiapp</code> D&aacute; acesso a recursos da interface do Revit. Com essa vari&aacute;vel podemos acessar coisas como a barra de ferramentas, janelas, etc.</p></li></ul></section><section class="chapter"><h3 id="vari-veis-de-input-e-output" data-toc="vari-veis-de-input-e-output">Vari&aacute;veis de input e output</h3><div class="code-block" data-lang="python">
inputFromDynamo = IN[0]

result = []
</div></section><section class="chapter"><h3 id="c-digo-principal" data-toc="c-digo-principal">C&oacute;digo principal</h3><div class="code-collapse" data-lang="python" data-is-expanded="false" data-synopsis="Código principal">
try:
  errorReport = None

  # transaction
  TransactionManager.Instance.EnsureInTransaction(doc)

  # Your Code Here

  TransactionManager.Instance.TransactionTaskDone()

except Exception as e:
  # if error occurs anywhere in the process catch it
  errorReport = traceback.format_exc()

# Assign your output to the OUT variable
if errorReport is None:
  OUT = result
else:
  OUT = errorReport
</div><aside class="prompt" data-type="warning" data-title="" id="-16uigk_102"><p id="-16uigk_103">S&oacute; &eacute; necess&aacute;rio usar uma <code class="code" id="-16uigk_107">Trasaction</code> se voc&ecirc; for alterar o modelo do Revit.</p><p id="-16uigk_104">Caso contr&aacute;rio, pode apagar as linhas</p><p id="-16uigk_105"><code class="code" id="-16uigk_108">TransactionManager.Instance.EnsureInTransaction(doc)</code></p><p id="-16uigk_106"><code class="code" id="-16uigk_109">TransactionManager.Instance.TransactionTaskDone()</code>.</p></aside></section></section><section class="chapter"><h2 id="como-usar-o-template-no-pycharm" data-toc="como-usar-o-template-no-pycharm">Como usar o Template no PyCharm</h2><p id="-16uigk_110">Baixe o arquivo do template no link abaixo e em seguida siga as instru&ccedil;&otilde;es para configur&aacute;-lo no PyCharm.</p><p> <a data-external="true" id="-16uigk_111" href="resources/onBIM-Template.py" target="_blank" rel="noopener noreferrer">onBIM-Template.py</a></p><section class="procedure-steps"><h3 id="pycharm-file-template-config" data-toc="pycharm-file-template-config">Configuração</h3><ol class="list _decimal"><li class="list__item" id="-16uigk_118"><p id="-16uigk_126">Clique no menu <span class="menupath" id="-16uigk_127">File</span></p></li><li class="list__item" id="-16uigk_119"><p id="-16uigk_128">Selecione <span class="menupath" id="-16uigk_129">Settings</span></p></li><li class="list__item" id="-16uigk_120"><p id="-16uigk_130">Na janela de configura&ccedil;&otilde;es, expanda o item <span class="menupath" id="-16uigk_131">Editor</span></p></li><li class="list__item" id="-16uigk_121"><p id="-16uigk_132">Selecione <span class="menupath" id="-16uigk_133">File and Code Templates</span></p></li><li class="list__item" id="-16uigk_122"><p id="-16uigk_134">Clique no bot&atilde;o <span class="menupath" id="-16uigk_135">+</span> para adicionar um novo template</p></li><li class="list__item" id="-16uigk_123"><p id="-16uigk_136">Digite um nome para seu template</p></li><li class="list__item" id="-16uigk_124"><p id="-16uigk_137">Cole o conte&uacute;do do arquivo <a data-external="true" id="-16uigk_138" href="resources/onBIM-Template.py" target="_blank" rel="noopener noreferrer">onBIM-Template.py</a> no campo de texto</p></li><li class="list__item" id="-16uigk_125"><p id="-16uigk_139">Clique em <span class="menupath" id="-16uigk_140">Apply</span> e depois em <span class="menupath" id="-16uigk_141">OK</span></p></li></ol></section><figure id="-16uigk_113"><img alt="Passo 01" src="images/config_py_temp_step_00.png" title="Passo 01" width="578" height="695"></figure><figure id="-16uigk_114"><img alt="Passo 02" src="images/config_py_temp_step_01.png" title="Passo 02" width="1120" height="936"></figure><figure id="-16uigk_115"><img alt="Passo 03" src="images/config_py_temp_step_02.png" title="Passo 03" width="1120" height="936"></figure><section class="procedure-steps"><h3 id="-16uigk_116" data-toc="-16uigk_116">Criando um novo arquivo a partir do Template</h3><ol class="list _decimal"><li class="list__item" id="-16uigk_142"><p id="-16uigk_146">Clique com o bot&atilde;o direito na pasta onde deseja criar o arquivo</p></li><li class="list__item" id="-16uigk_143"><p id="-16uigk_147">Selecione <span class="menupath" id="-16uigk_148">New</span></p></li><li class="list__item" id="-16uigk_144"><p id="-16uigk_149">Selecione o nome do template que voc&ecirc; criou</p></li><li class="list__item" id="-16uigk_145"><p id="-16uigk_150">Digite o nome do novo arquivo e clique em <span class="menupath" id="-16uigk_151">OK</span></p></li></ol></section><figure id="-16uigk_117"><img alt="creating new file" src="images/creating_new_file_from_template.png" title="creating new file" width="1324" height="797"></figure></section><div class="last-modified">Last modified: 27 November 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="libs-externas.html" class="navigation-links__prev">Libs externas</a><a href="aula-002.html" class="navigation-links__next">Aula 002</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.js"></script></body></html>