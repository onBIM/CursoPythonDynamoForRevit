<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-11-29T17:03:54.9915063"><title>Coleta de Elementos | ConteÃºdo do Curso Python para Dynamo do Revit</title><script type="application/json" id="virtual-toc-data">[{"id":"filteredelementcollector","level":0,"title":"FilteredElementCollector","anchor":"#filteredelementcollector"},{"id":"coleta","level":0,"title":"Coleta","anchor":"#coleta"},{"id":"filtragem","level":0,"title":"Filtragem","anchor":"#filtragem"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Coleta de Elementos | ConteÃºdo do Curso Python para Dynamo do Revit"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="ConteÃºdo do Curso Python para Dynamo do Revit Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/coleta-de-elementos.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Coleta de Elementos | ConteÃºdo do Curso Python para Dynamo do Revit"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/coleta-de-elementos.html#webpage",
    "url": "writerside-documentation/coleta-de-elementos.html",
    "name": "Coleta de Elementos | ConteÃºdo do Curso Python para Dynamo do Revit",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "ConteÃºdo do Curso Python para Dynamo do Revit Help"
}</script><!-- End Schema.org --></head><body data-id="Coleta-de-Elementos" data-main-title="Coleta de Elementos" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Aula-006.md|Aula 006"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>ConteÃºdo do Curso Python para Dynamo do Revit  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Coleta-de-Elementos" id="Coleta-de-Elementos.md">Coleta de Elementos</h1><p id="-kc309x_3">Sabemos que na biblioteca padr&atilde;o do Dynamo existem alguns nodes que nos ajudam a coletar elementos do Revit. Por&eacute;m, muitas vezes esses nodes n&atilde;o s&atilde;o suficientes para o que precisamos.</p><p id="-kc309x_4">J&aacute; que dispomos do Python, que por sua vez nos d&aacute; acesso direto a API do Revit, o mais recomendado &eacute; que usemos o Python para coletar elementos.</p><p id="-kc309x_5">A ferramenta que usaremos para isso &eacute; o <code class="code" id="-kc309x_9">FilteredElementCollector</code>.</p><section class="chapter"><h2 id="filteredelementcollector" data-toc="filteredelementcollector">FilteredElementCollector</h2><p id="-kc309x_10">Segundo a documenta&ccedil;&atilde;o da API do Revit,</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_11"><p id="-kc309x_15">O <a href="https://www.revitapidocs.com/2024/263cf06b-98be-6f91-c4da-fb47d01688f3.htm" id="-kc309x_16" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_18">FilteredElementCollector</code></a> &eacute; uma classe usada para procurar, filtrar e <a href="https://bit.ly/3OdTK6f" id="-kc309x_17" data-external="true" rel="noopener noreferrer">iterar</a> sobre um conjunto de elementos do Revit.</p></aside><figure id="-kc309x_12"><a href="images/filtered-element-collector-class.png" class="lightbox"><img alt="filtered-element-collector-class.png" src="images/filtered-element-collector-class.png" title="filtered-element-collector-class.png" width="1222" height="539"></a></figure><p id="-kc309x_13">Ela &eacute; a melhor maneira de coletar elementos do Revit, pois &eacute; a mais eficiente e a que consome menos recursos do computador.</p><p id="-kc309x_14">Os pr&oacute;prios nodes do Dynamo que coletam elementos usam o <code class="code" id="-kc309x_19">FilteredElementCollector</code> por baixo dos panos.</p></section><section class="chapter"><h2 id="coleta" data-toc="coleta">Coleta</h2><p id="-kc309x_20">O procedimento abaixo mostra como usar o <code class="code" id="-kc309x_22">FilteredElementCollector</code> para coletar elementos do Revit.</p><section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="using-filtered-element-collector" data-toc="using-filtered-element-collector">Usando o FilteredElementCollector</h3></div><div class="collapse__content"><ol class="list _decimal"><li class="list__item" id="-kc309x_23"><p id="-kc309x_28">Configurar o nosso node Python Script para usar o IronPython como engine.</p><p id="-kc309x_29">Na nossa <b id="-kc309x_30">Aula 001</b>, mostramos como fazer isso no t&oacute;pico <a href="cpython-x-ironpython.html" id="-kc309x_31" data-tooltip="O CPython Ã© a implementaÃ§Ã£o padrÃ£o da linguagem Python, enquanto o IronPython Ã© uma implementaÃ§Ã£o alternativa desenvolvida para rodar na plataforma .NET.">CPython x IronPython</a>.</p></li><li class="list__item" id="-kc309x_24"><p id="-kc309x_32">Importar todas as refer&ecirc;ncias da API do Revit para podermos us&aacute;-las no nosso c&oacute;digo.</p><p id="-kc309x_33">Veja o t&oacute;pico <a href="template-python-onbim.html" id="-kc309x_36" data-tooltip="O template Python onBIM Ã© um arquivo Python que contÃ©m um conjunto de imports e unÃ§Ãµes, comumente utilizadas em scripts para programar para a API do Revit.">Template Python onBIM</a> para ver como fazer isso.</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_34"><p>Lembre-se tamb&eacute;m de importar as refer&ecirc;ncias de <b id="-kc309x_37">Linq</b> e <b id="-kc309x_38">System List</b>.</p></aside><p id="-kc309x_35">Apesar de n&atilde;o utilizarmos elas incialmente, vai ser muito comum precisar depois. Ent&atilde;o aproveita e j&aacute; vai se acostumando a fazer isso.</p></li><li class="list__item" id="-kc309x_25"><p id="-kc309x_39">Criar uma inst&acirc;ncia da classe <code class="code" id="-kc309x_44">FilteredElementCollector</code></p><p id="-kc309x_40">Para isso, usamos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            collector = FilteredElementCollector(doc)
        </div><p id="-kc309x_42">Usando nosso template, como recomendado, ao final seu c&oacute;digo deve ter algo parecido com isso:</p><div class="code-collapse" data-lang="python" data-is-expanded="false" data-synopsis="CÃ³digo bÃ¡sico para usar API do Revit" data-disable-link-processing="true"># by onBIM Technology
# www.onbim.net
# file name: ./${DIR_PATH}/${FILE_NAME}

# REFERENCES AND IMPORTS
# BEGIN&gt;&gt;&gt;&gt;&gt;

import clr
import System

# &lt;&lt;&lt; Python Modules &gt;&gt;&gt;
# BEGIN

# Import traceback module from Iron Python
import traceback

# END

# Import System Libraries
clr.AddReference(&quot;System.Core&quot;)
from System.Collections.Generic import List as SystemList

# Import Linq
clr.ImportExtensions(System.Linq)

# Import Dynamo Library Nodes - Revit
clr.AddReference(&quot;RevitNodes&quot;)
import Revit as RevitNodes

# Import ToDSType(bool) extension method
clr.ImportExtensions(RevitNodes.Elements)
clr.ImportExtensions(RevitNodes.GeometryConversion)

# Import DocumentManager and TransactionManager
clr.AddReference(&quot;RevitServices&quot;)
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager

# Import Revit API
clr.AddReference(&quot;RevitAPI&quot;)
import Autodesk
from Autodesk.Revit.DB import *
# REFERENCES AND IMPORTS
# END&lt;&lt;&lt;&lt;&lt;

# INPUTS AND VARIABLES DECLARATIONS
# BEGIN&gt;&gt;&gt;&gt;&gt;

doc = DocumentManager.Instance.CurrentDBDocument

inputFromDynamo = IN[0]

result = []

# INPUTS AND VARIABLES DECLARATIONS
# END&lt;&lt;&lt;&lt;&lt;

# MAIN CODE
# BEGIN&gt;&gt;&gt;&gt;&gt;

try:
    errorReport = None
    
    collector = FilteredElementCollector(doc)
    
except Exception as e:
    # if error occurs anywhere in the process catch it
    errorReport = traceback.format_exc()

# Assign your output to the OUT variable
if errorReport is None:
    OUT = result
else:
    OUT = errorReport
# MAIN CODE
# END&lt;&lt;&lt;&lt;&lt;


</div></li><li class="list__item" id="-kc309x_26"><p id="-kc309x_45">Filtrando por Categoria ou pela Classe que representa a inst&acirc;ncia de fam&iacute;lia de sistema.</p><p id="-kc309x_46">Para isso, usamos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/c3523c35-4a07-9723-3c28-de3cc47b2ad0.htm" id="-kc309x_56" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_58">OfCategory()</code></a> ou <a href="https://www.revitapidocs.com/2024/b0a5f22c-6951-c3af-cd29-1f28f574035d.htm" id="-kc309x_57" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_59">OfClass()</code></a>.</p><p id="-kc309x_47">Por exemplo, se quisermos coletar todas as paredes do projeto usando o m&eacute;todo <code class="code" id="-kc309x_60">OfCategory()</code> e armazenar na vari&aacute;vel <code class="code" id="-kc309x_61">walls</code>, teremos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            walls = collector.OfCategory(BuiltInCategory.OST_Walls)
        </div><aside class="prompt" data-type="warning" data-title="" id="warning-about-ofcategory"><p>Note que usando o m&eacute;todo <code class="code" id="-kc309x_62">OfCategory()</code> todos os elementos que pertencem &agrave; <code class="code" id="-kc309x_63">BuiltInCategory.OST_Walls</code> ser&atilde;o coletados. Isso incluir&aacute;: </p><ul class="list _bullet" id="-kc309x_64"><li class="list__item" id="-kc309x_65"><p>As <b id="-kc309x_68">inst&acirc;ncias</b> de paredes de sistema.</p></li><li class="list__item" id="-kc309x_66"><p id="-kc309x_69">Os <b id="-kc309x_71"><em id="-kc309x_73">Types</em></b> de paredes. Sim, eles tamb&eacute;m ser&atilde;o coletados, pois tamb&eacute;m fazem parte da categoria <code class="code" id="-kc309x_72">Walls</code>.</p><p id="-kc309x_70">Veja a imagem abaixo da inspe&ccedil;&atilde;o de uma parede do modelo usando o <a href="https://github.com/jeremytammik/RevitLookup" id="-kc309x_74" data-external="true" rel="noopener noreferrer">Revit Lookup</a> ðŸ‘‡ <figure id="-kc309x_75"><a href="images/wall-inspection.png" class="lightbox"><img alt="Inpe&ccedil;&atilde;o de parede com o Revit Lookup" src="images/wall-inspection.png" class="article__bordered-element" title="Inpe&ccedil;&atilde;o de parede com o Revit Lookup" width="1625" height="1032"></a></figure></p></li><li class="list__item" id="-kc309x_67"><p>As inst&acirc;ncias de paredes <b id="-kc309x_76"><em id="-kc309x_77">Model-in-place</em></b></p></li></ul></aside><p id="-kc309x_50">Portanto, ser&aacute; necess&aacute;rio mais filtragens para obter os resultados que queremos, pois raramente iremos querer todos os elementos da categoria sem qualquer filtragem. Veremos como fazer isso na <a href="aula-007.html" id="-kc309x_78" data-tooltip="Nesta aula vamos conhecer mais recursos para filtragens avanÃ§adas de elementos no Revit e tambÃ©m obtenÃ§Ã£o de dados dos elementos, utilizando Linq.">Aula 007</a>.</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_51"><p>Para ver uma lista completa de todas as <code class="code" id="-kc309x_79">BuiltInCategory</code> acesse <a href="https://www.revitapidocs.com/2024/ba1c5b30-242f-5fdc-8ea9-ec3b61e6e722.htm" id="-kc309x_80" data-external="true" rel="noopener noreferrer">Revit API docs | BuiltInCategory</a></p></aside><p id="-kc309x_52">Por outro lado, se quisermos coletar todas as paredes do projeto usando o m&eacute;todo <code class="code" id="-kc309x_81">OfClass()</code> e armazenar na vari&aacute;vel <code class="code" id="-kc309x_82">walls</code>, teremos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            walls = collector.OfClass(Wall)
        </div><aside class="prompt" data-type="note" data-title="" id="-kc309x_54"><p>Note que agora como estamos usando o m&eacute;todo <code class="code" id="-kc309x_83">OfClass()</code>, apenas as <u id="-kc309x_84">inst&acirc;ncias de paredes de <b id="-kc309x_85">sistema</b></u> ser&atilde;o coletadas.</p></aside><aside class="prompt" data-type="tip" data-title="" id="-kc309x_55"><p>Lembre-se do t&oacute;pico <a href="conceitos-sobre-familias.html" id="-kc309x_86" data-tooltip="Tem mais alguns conceitos sobre a API do Revit que sÃ£o fundamentais antes de comeÃ§armos a programar. Esses conceitos sÃ£o sobre as famÃ­lias no Revit.">Esp&eacute;cies de Fam&iacute;lias na API do Revit</a> desse curso.</p></aside></li><li class="list__item" id="-kc309x_27"><p id="-kc309x_87">Transformar o <code class="code" id="-kc309x_94">FilteredElementCollector</code> em uma lista de <code class="code" id="-kc309x_95">Element</code> ou de <code class="code" id="-kc309x_96">ElementId</code>.</p><p id="-kc309x_88">O mais comum &eacute; utilizarmos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/732b4a0d-62d8-b86d-120b-8ea3d9713b34.htm" id="-kc309x_97" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_100">ToElements()</code></a>, que, como o pr&oacute;prio nome diz, transforma o <code class="code" id="-kc309x_98">FilteredElementCollector</code> em uma lista de <code class="code" id="-kc309x_99">Element</code>.</p><div class="code-block" data-lang="python">
            walls = collector.OfCategory(BuiltInCategory.OST_Walls).ToElements()
        </div><figure id="-kc309x_90"><a href="images/collect-walls.png" class="lightbox"><img alt="Coletando paredes por categoria" src="images/collect-walls.png" title="Coletando paredes por categoria" width="1461" height="893"></a></figure><p id="-kc309x_91">Por outro lado, se quisermos uma lista de <code class="code" id="-kc309x_101">ElementId</code>, utilizamos o m&eacute;todo <code class="code" id="-kc309x_102">ToElementIds()</code>:</p><div class="code-block" data-lang="python">
            walls_ids = collector.OfCategory(BuiltInCategory.OST_Walls).ToElementIds()
        </div><figure id="-kc309x_93"><a href="images/collect-walls-ids.png" class="lightbox"><img alt="Coletando ids por categoria" src="images/collect-walls-ids.png" title="Coletando ids por categoria" width="2081" height="910"></a></figure></li></ol></div></div></section></section><section class="chapter"><h2 id="filtragem" data-toc="filtragem">Filtragem</h2><p id="-kc309x_103">Antes de coverter o <code class="code" id="-kc309x_107">FilteredElementCollector</code> para lista podemos fazer muitas outras filtragens.</p><section class="chapter"><h3 id="filtrando-types-e-instances" data-toc="filtrando-types-e-instances">Filtrando <span class="emphasis" id="-kc309x_116">Types</span> e <span class="emphasis" id="-kc309x_117">Instances</span></h3><p id="-kc309x_109">Existem dois m&eacute;todos utilizados para filtrar <span class="emphasis" id="-kc309x_118">Types</span> e <span class="emphasis" id="-kc309x_119">Instances</span> de elementos.</p><dl id="-kc309x_110" data-style="title-top"><dt id="-kc309x_120" data-expandable="false"><span class="control" id="-kc309x_124"><a href="https://www.revitapidocs.com/2024/77793daa-5a26-b4d6-9019-4d998a55099e.htm" id="-kc309x_125" data-external="true" rel="noopener noreferrer">WhereElementIsElementType()</a></span></dt><dd><p id="-kc309x_123">Esse m&eacute;todo &eacute; utilizado para filtrar <span class="emphasis" id="-kc309x_126">Types</span> de elementos.</p></dd><dt id="-kc309x_121" data-expandable="false"><span class="control" id="-kc309x_129"><a href="https://www.revitapidocs.com/2024/061cbbb9-26f1-a8f8-a4b2-3d7ff0105199.htm" id="-kc309x_130" data-external="true" rel="noopener noreferrer">WhereElementIsNotElementType()</a></span></dt><dd><p id="-kc309x_128">Esse m&eacute;todo &eacute; utilizado para filtrar <span class="emphasis" id="-kc309x_131">Instances</span> de elementos.</p></dd></dl><aside class="prompt" data-type="note" data-title="" id="-kc309x_111"><p id="-kc309x_132">Veja que no <a href="#warning-about-ofcategory" id="-kc309x_133" data-tooltip="O procedimento abaixo mostra como usar o FilteredElementCollector para coletar elementos do Revit.">aviso sobre o m&eacute;todo <code class="code" id="-kc309x_136">OfCategory()</code></a> podemos sanar o problema de vir <span class="emphasis" id="-kc309x_134">Types</span> e <span class="emphasis" id="-kc309x_135">Instances</span> juntos, utilizando um desses m&eacute;todos para filtrar o que queremos.</p></aside><p id="-kc309x_112">Portanto, se quisermos coletar <span class="control" id="-kc309x_137">apenas os <span class="emphasis" id="-kc309x_139">Types</span></span> de paredes, usamos o m&eacute;todo <code class="code" id="-kc309x_138">WhereElementIsElementType()</code>.</p><div class="code-block" data-lang="python">
walls_types = \
	collector \
	.OfCategory(BuiltInCategory.OST_Walls) \
	.WhereElementIsElementType() \
	.ToElements()
</div><p id="-kc309x_114">Por outro lado, se quisermos coletar <span class="control" id="-kc309x_140">apenas as <span class="emphasis" id="-kc309x_142">Instances</span></span> de paredes, usamos o m&eacute;todo <code class="code" id="-kc309x_141">WhereElementIsNotElementType()</code>.</p><div class="code-block" data-lang="python">
walls_instances = \
	collector \
	.OfCategory(BuiltInCategory.OST_Walls) \
	.WhereElementIsNotElementType() \
	.ToElements()
</div></section><section class="chapter"><h3 id="wherepasses" data-toc="wherepasses">WherePasses()</h3><p id="-kc309x_143">Para isso utilizamos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/42d4eef3-55a1-2739-0ef8-6bc1d9fc2755.htm" id="-kc309x_149" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_152">WherePasses()</code></a><br> do <code class="code" id="-kc309x_151">FilteredElementCollector</code>.</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_144"><p id="-kc309x_153">Note que este m&eacute;todo recebe um objeto do tipo <a href="https://www.revitapidocs.com/2024/b8b46cbf-9ecc-0745-ec53-c3c3b6510113.htm" id="-kc309x_154" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_155">ElementFilter</code></a> como argumento.</p></aside><figure id="-kc309x_145"><a href="images/wherepasses-method.png" class="lightbox"><img alt="wherepasses-method.png" src="images/wherepasses-method.png" title="wherepasses-method.png" width="400" height="347"></a></figure><p id="-kc309x_146">O <code class="code" id="-kc309x_156">ElementFilter</code> &eacute; uma classe base que possui tr&ecirc;s classes principais derivadas que caracterizam o &quot;tipo&quot; de filtro:</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_147"><p id="-kc309x_157">Cada uma dessas classes por sua vez possui v&aacute;rias classes derivadas que representam os filtros espec&iacute;ficos que realizam a filtragem.</p><p id="-kc309x_158">S&atilde;o elas, na verdade, que iremos passar como argumento para o m&eacute;todo <code class="code" id="-kc309x_159">WherePasses()</code>.</p></aside><section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="-kc309x_148" data-toc="-kc309x_148">Tipos de filtro</h3></div><div class="collapse__content"><ol class="list _decimal"><li class="list__item" id="-kc309x_160"><p id="-kc309x_163"><a href="https://www.revitapidocs.com/2024/3b8d6b55-0cab-1810-1188-840800e5eaa2.htm" id="-kc309x_167" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_168">ElementLogicalFilter</code></a></p><p id="-kc309x_164">Essa classe &eacute; utilizada para combinar v&aacute;rios filtros</p><p id="-kc309x_165">Classes derivadas:</p><figure id="-kc309x_166"><a href="images/element-logical-filter.png" class="lightbox"><img alt="ElementLogicalFilter" src="images/element-logical-filter.png" title="ElementLogicalFilter" width="500" height="223"></a></figure></li><li class="list__item" id="-kc309x_161"><p id="-kc309x_169"><a href="https://www.revitapidocs.com/2024/ebc95d82-11fc-69f6-2df1-52331dd36443.htm" id="-kc309x_174" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_175">ElementQuickFilter</code></a></p><p id="-kc309x_170">Essa classe &eacute; utilizada para filtrar elementos de forma r&aacute;pida</p><p id="-kc309x_171">Classes derivadas:</p><figure id="-kc309x_172"><a href="images/element-quick-filter.png" class="lightbox"><img alt="ElementQuickFilter" src="images/element-quick-filter.png" title="ElementQuickFilter" width="500" height="513"></a></figure><p id="-kc309x_173">As mais usadas s&atilde;o: <code class="code" id="-kc309x_176">BoundingBoxIntersectsFilter</code> e <code class="code" id="-kc309x_177">ElementMulticategoryFilter</code></p></li><li class="list__item" id="-kc309x_162"><p id="-kc309x_178"><a href="https://www.revitapidocs.com/2024/e06b1e14-dd8d-8137-74ac-8ac4929eee85.htm" id="-kc309x_184" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_185">ElementSlowFilter</code></a></p><p id="-kc309x_179">Essa classe &eacute; utilizada para filtrar elementos de forma mais lenta.</p><aside class="prompt" data-type="warning" data-title="" id="-kc309x_180"><p>Cuidado. Esse filtro &eacute; bastante lento e consome bem mais mem&oacute;ria, como pode ser visto na sess&atilde;o <em id="-kc309x_186">Remarks</em> da documenta&ccedil;&atilde;o.</p></aside><p id="-kc309x_181">Classes derivadas:</p><figure id="-kc309x_182"><a href="images/element-slow-filter.png" class="lightbox"><img alt="ElementSlowFilter" src="images/element-slow-filter.png" title="ElementSlowFilter" width="500" height="863"></a></figure><p id="-kc309x_183">A mais usada &eacute;: <code class="code" id="-kc309x_187">ElementIntersectsFilter</code></p></li></ol></div></div></section></section><section class="chapter"><h3 id="exemplos-de-filtragem-com-wherepasses" data-toc="exemplos-de-filtragem-com-wherepasses">Exemplos de filtragem com <code class="code" id="-kc309x_194">WherePasses()</code></h3><p id="-kc309x_189">Uma das formas mais diretas para realizar filtragem dos elementos &eacute; usando o m&eacute;todo <code class="code" id="-kc309x_195">WherePasses()</code> para filtrar.</p><p id="-kc309x_190">Em seguida veremos alguns exemplos de como utiliz&aacute;-lo.</p><aside class="prompt" data-type="note" data-title="" id="-kc309x_191"><p>Vamos utilizar o modelo <b id="-kc309x_196">rac_basic_sample_project.rvt</b> nos nossos exemplos.</p></aside><section class="chapter"><h4 id="usando-um-elementquickfilter" data-toc="usando-um-elementquickfilter">Usando um <code class="code" id="-kc309x_206">ElementQuickFilter</code></h4><p id="-kc309x_198">Vamos o usar o <a href="https://www.revitapidocs.com/2024/34f8d848-4440-e880-3277-4f90e5cf3072.htm" id="-kc309x_207" data-external="true" rel="noopener noreferrer"><code class="code" id="-kc309x_208">ElementMulticategoryFilter</code></a> para filtrar elementos de v&aacute;rias categorias.</p><p id="-kc309x_199">Esse filtro possui v&aacute;rias formas de instanci&aacute;-lo, por&eacute;m a mais comum &eacute; passando uma lista de <code class="code" id="-kc309x_209">BuiltInCategory</code> como argumento.</p><figure id="-kc309x_200"><a href="images/mult-cat-filter-constructors.png" class="lightbox"><img alt="mult-cat-filter-constructors.png" src="images/mult-cat-filter-constructors.png" title="mult-cat-filter-constructors.png" width="1058" height="593"></a></figure><div class="code-block" data-lang="python">
# Criando uma System List de BuiltInCategory, 
# pois o construtor do ElementMulticategoryFilter 
# nÃ£o aceita uma lista Python    
cats = SystemList[BuiltInCategory]([
    BuiltInCategory.OST_Walls,
    BuiltInCategory.OST_Floors
])

multCatFilter = ElementMulticategoryFilter(cats)

walls_and_floors = \
    FilteredElementCollector(doc) \
    .WherePasses(multCatFilter) \
    .ToElements()

result = walls_and_floors
</div><aside class="prompt" data-type="note" data-title="" id="-kc309x_202"><p id="-kc309x_210">Veja como foi necess&aacute;rio criar uma <code class="code" id="-kc309x_212">List</code> do <code class="code" id="-kc309x_213">System</code> para poder utilizar o construtor do filtro.</p><p id="-kc309x_211">Falamos disso no t&oacute;p&iacute;co <a href="collections-system.html" id="-kc309x_214" data-tooltip="As coleÃ§Ãµes do System em C# sÃ£o estruturas de dados que permitem armazenar e gerenciar grupos de objetos. Aqui estÃ£o trÃªs das mais usadas:">Cole&ccedil;&otilde;es | System</a></p></aside><aside class="prompt" data-type="tip" data-title="" id="-kc309x_203"><p id="-kc309x_215">Perceba que para evitarmos linhas de c&oacute;digo muito longas, que podem ser dif&iacute;ceis de ler, utilizamos a barra invertida `\` para quebrar a linha.</p><p id="-kc309x_216">Essa &eacute; forma que o Python permite quebrar uma linha de c&oacute;digo sem causar erros de sintaxe.</p></aside><figure id="-kc309x_204"><a href="images/collecting-walls-and-floors.png" class="lightbox"><img alt="collecting-walls-and-floors.png" src="images/collecting-walls-and-floors.png" title="collecting-walls-and-floors.png" width="1538" height="936"></a></figure><aside class="prompt" data-type="note" data-title="" id="-kc309x_205"><p id="-kc309x_217">Note tamb&eacute;m que foi necess&aacute;rio mudarmos a engine Python para <code class="code" id="-kc309x_219">IronPython</code> para que o c&oacute;digo acima funcionasse.</p><p id="-kc309x_218">Falamos sobre isso no t&oacute;pico <a href="cpython-x-ironpython.html" id="-kc309x_220" data-tooltip="O CPython Ã© a implementaÃ§Ã£o padrÃ£o da linguagem Python, enquanto o IronPython Ã© uma implementaÃ§Ã£o alternativa desenvolvida para rodar na plataforma .NET.">CPython x IronPython</a></p></aside></section><section class="chapter"><h4 id="usando-um-elementlogicalfilter" data-toc="usando-um-elementlogicalfilter">Usando um <code class="code" id="-kc309x_230">ElementLogicalFilter</code></h4><p id="-kc309x_222">Vamos usar o <code class="code" id="-kc309x_231">ElementLogicalFilter</code> para combinar dois filtros.</p><p id="-kc309x_223">No exemplo a seguir queremos coletar todas as <span class="emphasis" id="-kc309x_232">Furnitures</span> e <span class="emphasis" id="-kc309x_233">Caseworks</span> que est&atilde;o sobre o piso.</p><figure id="-kc309x_224"><a href="images/kitchen-to-collect-furniture-on-floor.png" class="lightbox"><img alt="kitchen-to-collect-furniture-on-floor.png" src="images/kitchen-to-collect-furniture-on-floor.png" title="kitchen-to-collect-furniture-on-floor.png" width="1753" height="909"></a></figure><p id="-kc309x_225">Para isso vamos combinar um filtro de categoria com um filtro de interse&ccedil;&atilde;o de <span class="emphasis" id="-kc309x_234">BoundingBox</span>.</p><div class="code-collapse" data-lang="python" data-is-expanded="false" data-synopsis="CÃ³digo para coletar Furnitures e Caseworks sobre o piso" data-disable-link-processing="true">    # Categorias a filtrar	
    cats = SystemList[BuiltInCategory]([
        BuiltInCategory.OST_Furniture,
        BuiltInCategory.OST_Casework
    ])
    
    # Criando o filtro de multi-categoria
    multiCatFilter = ElementMulticategoryFilter(cats)
    
    # Obtendo o piso a partir da seleÃ§Ã£o do usuÃ¡rio no Dynamo
    floor = UnwrapElement(IN[0])
    
    bbox = floor.get_BoundingBox(None)
    outline = Outline(bbox.Min, bbox.Max)
    
    # Criando um filtro de interseÃ§Ã£o de BoundingBox
    bboxIntersectsFilter = BoundingBoxIntersectsFilter(outline)
    
    # Criando um filtro lÃ³gico AND
    filtersToCombine = SystemList[ElementFilter]([
        multiCatFilter,
        bboxIntersectsFilter
    ])
    
    logicalAndFilter = LogicalAndFilter(filtersToCombine)
    
    furnitures_and_caseworks_on_floor = \
        FilteredElementCollector(doc) \
        .WherePasses(logicalAndFilter) \
        .ToElements()
    
    result = furnitures_and_caseworks_on_floor</div><p id="-kc309x_227">Baixe o c&oacute;digo completo aqui ðŸ‘‰ <a data-external="true" id="-kc309x_235" href="resources/collecting-furnitures-and-caseworks-on-floor.py" target="_blank" rel="noopener noreferrer">collecting-furnitures-and-caseworks-on-floor.py</a>.</p><figure id="-kc309x_228"><a href="images/collect-furnitures_and-caseworks-on-floor.png" class="lightbox"><img alt="collect-furnitures_and-caseworks-on-floor.png" src="images/collect-furnitures_and-caseworks-on-floor.png" title="collect-furnitures_and-caseworks-on-floor.png" width="1899" height="1052"></a></figure><aside class="prompt" data-type="note" data-title="" id="-kc309x_229"><p id="-kc309x_236">Veja que foi necess&aacute;rio utilizar o m&eacute;todo <code class="code" id="-kc309x_238">UnwrapElement()</code> para <b id="-kc309x_239">converter</b> o elemento selecionado atrav&eacute;s do Dynamo para a API do Revit</p><p id="-kc309x_237">Falaremos mais sobre isso no t&oacute;pico a seguir ðŸ‘‰</p></aside></section></section></section><div class="last-modified">Last modified: 29 November 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="fluxo-geral-de-rotinas.html" class="navigation-links__prev">Fluxo geral de rotinas</a><a href="converting-objects-between-revit-and-dynamo.html" class="navigation-links__next">Convers&atilde;o de objetos Dynamo x Revit</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.js"></script></body></html>