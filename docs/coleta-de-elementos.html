<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-11-28T18:28:51.3667302"><title>Coleta de Elementos | Conteúdo do Curso Python para Dynamo do Revit</title><script type="application/json" id="virtual-toc-data">[{"id":"filteredelementcollector","level":0,"title":"FilteredElementCollector","anchor":"#filteredelementcollector"},{"id":"coleta","level":0,"title":"Coleta","anchor":"#coleta"},{"id":"filtragem","level":0,"title":"Filtragem","anchor":"#filtragem"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Coleta de Elementos | Conteúdo do Curso Python para Dynamo do Revit"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Conteúdo do Curso Python para Dynamo do Revit Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/coleta-de-elementos.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Coleta de Elementos | Conteúdo do Curso Python para Dynamo do Revit"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/coleta-de-elementos.html#webpage",
    "url": "writerside-documentation/coleta-de-elementos.html",
    "name": "Coleta de Elementos | Conteúdo do Curso Python para Dynamo do Revit",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Conteúdo do Curso Python para Dynamo do Revit Help"
}</script><!-- End Schema.org --></head><body data-id="Coleta-de-Elementos" data-main-title="Coleta de Elementos" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Aula-006.md|Aula 006"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Conteúdo do Curso Python para Dynamo do Revit  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Coleta-de-Elementos" id="Coleta-de-Elementos.md">Coleta de Elementos</h1><p id="-2mz4gf_3">Sabemos que na biblioteca padr&atilde;o do Dynamo existem alguns nodes que nos ajudam a coletar elementos do Revit. Por&eacute;m, muitas vezes esses nodes n&atilde;o s&atilde;o suficientes para o que precisamos.</p><p id="-2mz4gf_4">J&aacute; que dispomos do Python, que por sua vez nos d&aacute; acesso direto a API do Revit, o mais recomendado &eacute; que usemos o Python para coletar elementos.</p><p id="-2mz4gf_5">A ferramenta que usaremos para isso &eacute; o <code class="code" id="-2mz4gf_9">FilteredElementCollector</code>.</p><section class="chapter"><h2 id="filteredelementcollector" data-toc="filteredelementcollector">FilteredElementCollector</h2><p id="-2mz4gf_10">Segundo a documenta&ccedil;&atilde;o da API do Revit,</p><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_11"><p id="-2mz4gf_15">O <a href="https://www.revitapidocs.com/2024/263cf06b-98be-6f91-c4da-fb47d01688f3.htm" id="-2mz4gf_16" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_18">FilteredElementCollector</code></a> &eacute; uma classe usada para procurar, filtrar e <a href="https://bit.ly/3OdTK6f" id="-2mz4gf_17" data-external="true" rel="noopener noreferrer">iterar</a> sobre um conjunto de elementos do Revit.</p></aside><figure id="-2mz4gf_12"><a href="images/filtered-element-collector-class.png" class="lightbox"><img alt="filtered-element-collector-class.png" src="images/filtered-element-collector-class.png" title="filtered-element-collector-class.png" width="1222" height="539"></a></figure><p id="-2mz4gf_13">Ela &eacute; a melhor maneira de coletar elementos do Revit, pois &eacute; a mais eficiente e a que consome menos recursos do computador.</p><p id="-2mz4gf_14">Os pr&oacute;prios nodes do Dynamo que coletam elementos usam o <code class="code" id="-2mz4gf_19">FilteredElementCollector</code> por baixo dos panos.</p></section><section class="chapter"><h2 id="coleta" data-toc="coleta">Coleta</h2><p id="-2mz4gf_20">O procedimento abaixo mostra como usar o <code class="code" id="-2mz4gf_22">FilteredElementCollector</code> para coletar elementos do Revit.</p><section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="using-filtered-element-collector" data-toc="using-filtered-element-collector">Usando o FilteredElementCollector</h3></div><div class="collapse__content"><ol class="list _decimal"><li class="list__item" id="-2mz4gf_23"><p id="-2mz4gf_28">Configurar o nosso node Python Script para usar o IronPython como engine.</p><p id="-2mz4gf_29">Na nossa <b id="-2mz4gf_30">Aula 001</b>, mostramos como fazer isso no t&oacute;pico <a href="cpython-x-ironpython.html" id="-2mz4gf_31" data-tooltip="O CPython é a implementação padrão da linguagem Python, enquanto o IronPython é uma implementação alternativa desenvolvida para rodar na plataforma .NET.">CPython x IronPython</a>.</p></li><li class="list__item" id="-2mz4gf_24"><p id="-2mz4gf_32">Importar todas as refer&ecirc;ncias da API do Revit para podermos us&aacute;-las no nosso c&oacute;digo.</p><p id="-2mz4gf_33">Veja o t&oacute;pico <a href="template-python-onbim.html" id="-2mz4gf_36" data-tooltip="O template Python onBIM é um arquivo Python que contém um conjunto de imports e unções, comumente utilizadas em scripts para programar para a API do Revit.">Template Python onBIM</a> para ver como fazer isso.</p><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_34"><p>Lembre-se tamb&eacute;m de importar as refer&ecirc;ncias de <b id="-2mz4gf_37">Linq</b> e <b id="-2mz4gf_38">System List</b>.</p></aside><p id="-2mz4gf_35">Apesar de n&atilde;o utilizarmos elas incialmente, vai ser muito comum precisar depois. Ent&atilde;o aproveita e j&aacute; vai se acostumando a fazer isso.</p></li><li class="list__item" id="-2mz4gf_25"><p id="-2mz4gf_39">Criar uma inst&acirc;ncia da classe <code class="code" id="-2mz4gf_44">FilteredElementCollector</code></p><p id="-2mz4gf_40">Para isso, usamos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            collector = FilteredElementCollector(doc)
        </div><p id="-2mz4gf_42">Usando nosso template, como recomendado, ao final seu c&oacute;digo deve ter algo parecido com isso:</p><div class="code-collapse" data-lang="python" data-is-expanded="false" data-synopsis="Código básico para usar API do Revit" data-disable-link-processing="true"># by onBIM Technology
# www.onbim.net
# file name: ./${DIR_PATH}/${FILE_NAME}

# REFERENCES AND IMPORTS
# BEGIN&gt;&gt;&gt;&gt;&gt;

import clr
import System

# &lt;&lt;&lt; Python Modules &gt;&gt;&gt;
# BEGIN

# Import traceback module from Iron Python
import traceback

# END

# Import System Libraries
clr.AddReference(&quot;System.Core&quot;)
from System.Collections.Generic import List as SystemList

# Import Linq
clr.ImportExtensions(System.Linq)

# Import Dynamo Library Nodes - Revit
clr.AddReference(&quot;RevitNodes&quot;)
import Revit as RevitNodes

# Import ToDSType(bool) extension method
clr.ImportExtensions(RevitNodes.Elements)
clr.ImportExtensions(RevitNodes.GeometryConversion)

# Import DocumentManager and TransactionManager
clr.AddReference(&quot;RevitServices&quot;)
import RevitServices
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager

# Import Revit API
clr.AddReference(&quot;RevitAPI&quot;)
import Autodesk
from Autodesk.Revit.DB import *
# REFERENCES AND IMPORTS
# END&lt;&lt;&lt;&lt;&lt;

# INPUTS AND VARIABLES DECLARATIONS
# BEGIN&gt;&gt;&gt;&gt;&gt;

doc = DocumentManager.Instance.CurrentDBDocument

inputFromDynamo = IN[0]

result = []

# INPUTS AND VARIABLES DECLARATIONS
# END&lt;&lt;&lt;&lt;&lt;

# MAIN CODE
# BEGIN&gt;&gt;&gt;&gt;&gt;

try:
    errorReport = None
    
    collector = FilteredElementCollector(doc)
    
except Exception as e:
    # if error occurs anywhere in the process catch it
    errorReport = traceback.format_exc()

# Assign your output to the OUT variable
if errorReport is None:
    OUT = result
else:
    OUT = errorReport
# MAIN CODE
# END&lt;&lt;&lt;&lt;&lt;


</div></li><li class="list__item" id="-2mz4gf_26"><p id="-2mz4gf_45">Filtrando por Categoria ou pela Classe que representa a inst&acirc;ncia de fam&iacute;lia de sistema.</p><p id="-2mz4gf_46">Para isso, usamos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/c3523c35-4a07-9723-3c28-de3cc47b2ad0.htm" id="-2mz4gf_56" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_58">OfCategory()</code></a> ou <a href="https://www.revitapidocs.com/2024/b0a5f22c-6951-c3af-cd29-1f28f574035d.htm" id="-2mz4gf_57" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_59">OfClass()</code></a>.</p><p id="-2mz4gf_47">Por exemplo, se quisermos coletar todas as paredes do projeto usando o m&eacute;todo <code class="code" id="-2mz4gf_60">OfCategory()</code> e armazenar na vari&aacute;vel <code class="code" id="-2mz4gf_61">walls</code>, teremos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            walls = collector.OfCategory(BuiltInCategory.OST_Walls)
        </div><aside class="prompt" data-type="warning" data-title="" id="-2mz4gf_49"><p>Note que usando o m&eacute;todo <code class="code" id="-2mz4gf_62">OfCategory()</code> todos os elementos que pertencem &agrave; <code class="code" id="-2mz4gf_63">BuiltInCategory.OST_Walls</code> ser&atilde;o coletados. Isso incluir&aacute;: </p><ul class="list _bullet" id="-2mz4gf_64"><li class="list__item" id="-2mz4gf_65"><p>As <b id="-2mz4gf_68">inst&acirc;ncias</b> de paredes de sistema.</p></li><li class="list__item" id="-2mz4gf_66"><p id="-2mz4gf_69">Os <b id="-2mz4gf_71"><em id="-2mz4gf_73">Types</em></b> de paredes. Sim, eles tamb&eacute;m ser&atilde;o coletados, pois tamb&eacute;m fazem parte da categoria <code class="code" id="-2mz4gf_72">Walls</code>.</p><p id="-2mz4gf_70">Veja a imagem abaixo da inspe&ccedil;&atilde;o de uma parede do modelo usando o <a href="https://github.com/jeremytammik/RevitLookup" id="-2mz4gf_74" data-external="true" rel="noopener noreferrer">Revit Lookup</a> 👇 <figure id="-2mz4gf_75"><a href="images/wall-inspection.png" class="lightbox"><img alt="Inpe&ccedil;&atilde;o de parede com o Revit Lookup" src="images/wall-inspection.png" class="article__bordered-element" title="Inpe&ccedil;&atilde;o de parede com o Revit Lookup" width="1625" height="1032"></a></figure></p></li><li class="list__item" id="-2mz4gf_67"><p>As inst&acirc;ncias de paredes <b id="-2mz4gf_76"><em id="-2mz4gf_77">Model-in-place</em></b></p></li></ul></aside><p id="-2mz4gf_50">Portanto, ser&aacute; necess&aacute;rio mais filtragens para obter os resultados que queremos, pois raramente iremos querer todos os elementos da categoria sem qualquer filtragem. Veremos como fazer isso na <a href="aula-007.html" id="-2mz4gf_78" data-tooltip="Nesta aula vamos conhecer mais recursos para filtragens avançadas de elementos no Revit e também obtenção de dados dos elementos, utilizando Linq.">Aula 007</a>.</p><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_51"><p>Para ver uma lista completa de todas as <code class="code" id="-2mz4gf_79">BuiltInCategory</code> acesse <a href="https://www.revitapidocs.com/2024/ba1c5b30-242f-5fdc-8ea9-ec3b61e6e722.htm" id="-2mz4gf_80" data-external="true" rel="noopener noreferrer">Revit API docs | BuiltInCategory</a></p></aside><p id="-2mz4gf_52">Por outro lado, se quisermos coletar todas as paredes do projeto usando o m&eacute;todo <code class="code" id="-2mz4gf_81">OfClass()</code> e armazenar na vari&aacute;vel <code class="code" id="-2mz4gf_82">walls</code>, teremos o seguinte c&oacute;digo:</p><div class="code-block" data-lang="python">
            walls = collector.OfClass(Wall)
        </div><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_54"><p>Note que agora como estamos usando o m&eacute;todo <code class="code" id="-2mz4gf_83">OfClass()</code>, apenas as <u id="-2mz4gf_84">inst&acirc;ncias de paredes de <b id="-2mz4gf_85">sistema</b></u> ser&atilde;o coletadas.</p></aside><aside class="prompt" data-type="tip" data-title="" id="-2mz4gf_55"><p>Lembre-se do t&oacute;pico <a href="conceitos-sobre-familias.html" id="-2mz4gf_86" data-tooltip="Tem mais alguns conceitos sobre a API do Revit que são fundamentais antes de começarmos a programar. Esses conceitos são sobre as famílias no Revit.">Esp&eacute;cies de Fam&iacute;lias na API do Revit</a> desse curso.</p></aside></li><li class="list__item" id="-2mz4gf_27"><p id="-2mz4gf_87">Transformar o <code class="code" id="-2mz4gf_94">FilteredElementCollector</code> em uma lista de <code class="code" id="-2mz4gf_95">Element</code> ou de <code class="code" id="-2mz4gf_96">ElementId</code>.</p><p id="-2mz4gf_88">O mais comum &eacute; utilizarmos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/732b4a0d-62d8-b86d-120b-8ea3d9713b34.htm" id="-2mz4gf_97" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_100">ToElements()</code></a>, que, como o pr&oacute;prio nome diz, transforma o <code class="code" id="-2mz4gf_98">FilteredElementCollector</code> em uma lista de <code class="code" id="-2mz4gf_99">Element</code>.</p><div class="code-block" data-lang="python">
            walls = collector.OfCategory(BuiltInCategory.OST_Walls).ToElements()
        </div><figure id="-2mz4gf_90"><a href="images/collect-walls.png" class="lightbox"><img alt="Coletando paredes por categoria" src="images/collect-walls.png" title="Coletando paredes por categoria" width="1461" height="893"></a></figure><p id="-2mz4gf_91">Por outro lado, se quisermos uma lista de <code class="code" id="-2mz4gf_101">ElementId</code>, utilizamos o m&eacute;todo <code class="code" id="-2mz4gf_102">ToElementIds()</code>:</p><div class="code-block" data-lang="python">
            walls_ids = collector.OfCategory(BuiltInCategory.OST_Walls).ToElementIds()
        </div><figure id="-2mz4gf_93"><a href="images/collect-walls-ids.png" class="lightbox"><img alt="Coletando ids por categoria" src="images/collect-walls-ids.png" title="Coletando ids por categoria" width="2081" height="910"></a></figure></li></ol></div></div></section></section><section class="chapter"><h2 id="filtragem" data-toc="filtragem">Filtragem</h2><p id="-2mz4gf_103">Antes de coverter o <code class="code" id="-2mz4gf_113">FilteredElementCollector</code> para lista podemos fazer muitas outras filtragens.</p><p id="-2mz4gf_104">Para isso utilizamos o m&eacute;todo <a href="https://www.revitapidocs.com/2024/42d4eef3-55a1-2739-0ef8-6bc1d9fc2755.htm" id="-2mz4gf_114" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_117">WherePasses()</code></a><br> do <code class="code" id="-2mz4gf_116">FilteredElementCollector</code>.</p><p id="-2mz4gf_105">Note que este m&eacute;todo recebe um objeto do tipo <a href="https://www.revitapidocs.com/2024/b8b46cbf-9ecc-0745-ec53-c3c3b6510113.htm" id="-2mz4gf_118" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_119">ElementFilter</code></a> como argumento.</p><figure id="-2mz4gf_106"><a href="images/wherepasses-method.png" class="lightbox"><img alt="wherepasses-method.png" src="images/wherepasses-method.png" title="wherepasses-method.png" width="400" height="347"></a></figure><p id="-2mz4gf_107">O <code class="code" id="-2mz4gf_120">ElementFilter</code> &eacute; uma classe base que possui tr&ecirc;s classes principais derivadas que caracterizam o &quot;tipo&quot; de filtro:</p><p id="-2mz4gf_108">Cada uma dessas classes por sua vez possui v&aacute;rias classes derivadas que representam os filtros espec&iacute;ficos.</p><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_109"><p id="-2mz4gf_121">No nosso c&oacute;digo utilizamos essas &uacute;ltimas para criar os filtros.</p></aside><p id="-2mz4gf_110">Veja a lista abaixo 👇</p><section class="procedure-steps"><div class="collapse"><div class="collapse__title"><h3 id="-2mz4gf_111" data-toc="-2mz4gf_111">Tipos de filtro</h3></div><div class="collapse__content"><ol class="list _decimal"><li class="list__item" id="-2mz4gf_122"><p id="-2mz4gf_125"><a href="https://www.revitapidocs.com/2024/3b8d6b55-0cab-1810-1188-840800e5eaa2.htm" id="-2mz4gf_129" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_130">ElementLogicalFilter</code></a></p><p id="-2mz4gf_126">Essa classe &eacute; utilizada para combinar v&aacute;rios filtros</p><p id="-2mz4gf_127">Classes derivadas:</p><figure id="-2mz4gf_128"><a href="images/element-logical-filter.png" class="lightbox"><img alt="ElementLogicalFilter" src="images/element-logical-filter.png" title="ElementLogicalFilter" width="500" height="223"></a></figure></li><li class="list__item" id="-2mz4gf_123"><p id="-2mz4gf_131"><a href="https://www.revitapidocs.com/2024/ebc95d82-11fc-69f6-2df1-52331dd36443.htm" id="-2mz4gf_136" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_137">ElementQuickFilter</code></a></p><p id="-2mz4gf_132">Essa classe &eacute; utilizada para filtrar elementos de forma r&aacute;pida</p><p id="-2mz4gf_133">Classes derivadas:</p><figure id="-2mz4gf_134"><a href="images/element-quick-filter.png" class="lightbox"><img alt="ElementQuickFilter" src="images/element-quick-filter.png" title="ElementQuickFilter" width="500" height="513"></a></figure><p id="-2mz4gf_135">As mais usadas s&atilde;o: <code class="code" id="-2mz4gf_138">BoundingBoxIntersectsFilter</code> e <code class="code" id="-2mz4gf_139">ElementMulticategoryFilter</code></p></li><li class="list__item" id="-2mz4gf_124"><p id="-2mz4gf_140"><a href="https://www.revitapidocs.com/2024/e06b1e14-dd8d-8137-74ac-8ac4929eee85.htm" id="-2mz4gf_146" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_147">ElementSlowFilter</code></a></p><p id="-2mz4gf_141">Essa classe &eacute; utilizada para filtrar elementos de forma mais lenta.</p><aside class="prompt" data-type="warning" data-title="" id="-2mz4gf_142"><p>Cuidado. Esse filtro &eacute; bastante lento e consome bem mais mem&oacute;ria, como pode ser visto na sess&atilde;o <em id="-2mz4gf_148">Remarks</em> da documenta&ccedil;&atilde;o.</p></aside><p id="-2mz4gf_143">Classes derivadas:</p><figure id="-2mz4gf_144"><a href="images/element-slow-filter.png" class="lightbox"><img alt="ElementSlowFilter" src="images/element-slow-filter.png" title="ElementSlowFilter" width="500" height="863"></a></figure><p id="-2mz4gf_145">A mais usada &eacute;: <code class="code" id="-2mz4gf_149">ElementIntersectsFilter</code></p></li></ol></div></div></section><section class="chapter"><h3 id="exemplos-de-filtragem-com-wherepasses" data-toc="exemplos-de-filtragem-com-wherepasses">Exemplos de filtragem com <code class="code" id="-2mz4gf_156">WherePasses()</code></h3><p id="-2mz4gf_151">Uma das formas mais diretas para realizar filtragem dos elementos &eacute; como m&eacute;todo <code class="code" id="-2mz4gf_157">WherePasses()</code> para filtrar.</p><p id="-2mz4gf_152">Em seguida veremos alguns exemplos de como utiliz&aacute;-lo.</p><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_153"><p>Vamos utilizar o modelo <b id="-2mz4gf_158">rac_basic_sample_project.rvt</b> nos nossos exemplos.</p></aside><section class="chapter"><h4 id="usando-um-elementquickfilter" data-toc="usando-um-elementquickfilter">Usando um <code class="code" id="-2mz4gf_168">ElementQuickFilter</code></h4><p id="-2mz4gf_160">Vamos o usar o <a href="https://www.revitapidocs.com/2024/34f8d848-4440-e880-3277-4f90e5cf3072.htm" id="-2mz4gf_169" data-external="true" rel="noopener noreferrer"><code class="code" id="-2mz4gf_170">ElementMulticategoryFilter</code></a> para filtrar elementos de v&aacute;rias categorias.</p><p id="-2mz4gf_161">Esse filtro possui v&aacute;rias formas de instanci&aacute;-lo, por&eacute;m a mais comum &eacute; passando uma lista de <code class="code" id="-2mz4gf_171">BuiltInCategory</code> como argumento.</p><figure id="-2mz4gf_162"><a href="images/mult-cat-filter-constructors.png" class="lightbox"><img alt="mult-cat-filter-constructors.png" src="images/mult-cat-filter-constructors.png" title="mult-cat-filter-constructors.png" width="1058" height="593"></a></figure><div class="code-block" data-lang="python">
# Criando uma System List de BuiltInCategory, 
# pois o construtor do ElementMulticategoryFilter 
# não aceita uma lista Python    
cats = SystemList[BuiltInCategory]([
    BuiltInCategory.OST_Walls,
    BuiltInCategory.OST_Floors
])

multCatFilter = ElementMulticategoryFilter(cats)

walls_and_floors = \
    FilteredElementCollector(doc) \
    .WherePasses(multCatFilter) \
    .ToElements()

result = walls_and_floors
</div><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_164"><p id="-2mz4gf_172">Veja como foi necess&aacute;rio criar uma <code class="code" id="-2mz4gf_174">List</code> do <code class="code" id="-2mz4gf_175">System</code> para poder utilizar o construtor do filtro.</p><p id="-2mz4gf_173">Falamos disso no t&oacute;p&iacute;co <a href="collections-system.html" id="-2mz4gf_176" data-tooltip="As coleções do System em C# são estruturas de dados que permitem armazenar e gerenciar grupos de objetos. Aqui estão três das mais usadas:">Cole&ccedil;&otilde;es | System</a></p></aside><aside class="prompt" data-type="tip" data-title="" id="-2mz4gf_165"><p id="-2mz4gf_177">Perceba que para evitarmos linhas de c&oacute;digo muito longas, que podem ser dif&iacute;ceis de ler, utilizamos a barra invertida `\` para quebrar a linha.</p><p id="-2mz4gf_178">Essa &eacute; forma que o Python permite quebrar uma linha de c&oacute;digo sem causar erros de sintaxe.</p></aside><figure id="-2mz4gf_166"><a href="images/collecting-walls-and-floors.png" class="lightbox"><img alt="collecting-walls-and-floors.png" src="images/collecting-walls-and-floors.png" title="collecting-walls-and-floors.png" width="1538" height="936"></a></figure><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_167"><p id="-2mz4gf_179">Note tamb&eacute;m que foi necess&aacute;rio mudarmos a engine Python para <code class="code" id="-2mz4gf_181">IronPython</code> para que o c&oacute;digo acima funcionasse.</p><p id="-2mz4gf_180">Falamos sobre isso no t&oacute;pico <a href="cpython-x-ironpython.html" id="-2mz4gf_182" data-tooltip="O CPython é a implementação padrão da linguagem Python, enquanto o IronPython é uma implementação alternativa desenvolvida para rodar na plataforma .NET.">CPython x IronPython</a></p></aside></section><section class="chapter"><h4 id="usando-um-elementlogicalfilter" data-toc="usando-um-elementlogicalfilter">Usando um <code class="code" id="-2mz4gf_191">ElementLogicalFilter</code></h4><p id="-2mz4gf_184">Vamos usar o <code class="code" id="-2mz4gf_192">ElementLogicalFilter</code> para combinar dois filtros.</p><p id="-2mz4gf_185">No exemplo a seguir queremos coletar todas as <span class="emphasis" id="-2mz4gf_193">Furnitures</span> e <span class="emphasis" id="-2mz4gf_194">Caseworks</span> que est&atilde;o sobre o piso.</p><figure id="-2mz4gf_186"><a href="images/kitchen-to-collect-furniture-on-floor.png" class="lightbox"><img alt="kitchen-to-collect-furniture-on-floor.png" src="images/kitchen-to-collect-furniture-on-floor.png" title="kitchen-to-collect-furniture-on-floor.png" width="1753" height="909"></a></figure><p id="-2mz4gf_187">Para isso vamos combinar um filtro de categoria com um filtro de interse&ccedil;&atilde;o de <span class="emphasis" id="-2mz4gf_195">BoundingBox</span>.</p><div class="code-collapse" data-lang="python" data-is-expanded="false" data-synopsis="Código para coletar Furnitures e Caseworks sobre o piso">
1.  # Categorias a filtrar	
2.  cats = SystemList[BuiltInCategory]([
3.      BuiltInCategory.OST_Furniture,
4.      BuiltInCategory.OST_Casework
5.  ])
6.
7.  # Criando o filtro de multi-categoria
8.  multiCatFilter = ElementMulticategoryFilter(cats)
9.
10. # Obtendo o piso à partir da seleção do usuário no Dynamo
11. floor = UnwrapElement(IN[0])
12.
13. bbox = floor.get_BoundingBox(None)
14. outline = Outline(bbox.Min, bbox.Max)
15.
16. # Criando um filtro de interseção de BoundingBox
17. bboxIntersectsFilter = BoundingBoxIntersectsFilter(outline)
18.
19. # Criando um filtro lógico AND
20. filtersToCombine = SystemList[ElementFilter]([
21.     multiCatFilter,
22.     bboxIntersectsFilter
23. ])
24.
25. logicalAndFilter = LogicalAndFilter(filtersToCombine)
26.
27. furnitures_and_caseworks_on_floor = \
28.     FilteredElementCollector(doc) \
29.     .WherePasses(logicalAndFilter) \
30.     .ToElements()
31.
32. result = furnitures_and_caseworks_on_floor
</div><figure id="-2mz4gf_189"><a href="images/collect-furnitures_and-caseworks-on-floor.png" class="lightbox"><img alt="collect-furnitures_and-caseworks-on-floor.png" src="images/collect-furnitures_and-caseworks-on-floor.png" title="collect-furnitures_and-caseworks-on-floor.png" width="1899" height="1052"></a></figure><aside class="prompt" data-type="note" data-title="" id="-2mz4gf_190"><p id="-2mz4gf_196">Veja que foi necess&aacute;rio utilizar o m&eacute;todo <code class="code" id="-2mz4gf_198">UnwrapElement()</code> para <b id="-2mz4gf_199">converter</b> o elemento selecionado atrav&eacute;s do Dynamo para a API do Revit</p><p id="-2mz4gf_197">Falaremos mais sobre adiante.</p></aside></section></section></section><div class="last-modified">Last modified: 28 November 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="fluxo-geral-de-rotinas.html" class="navigation-links__prev">Fluxo geral de rotinas</a><a href="aula-007.html" class="navigation-links__next">Aula 007</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b518/app.js"></script></body></html>